this code is currently messy and undocumented.  cleanup and docs will
hopefully happen soon.  stay tuned.

-kevin

